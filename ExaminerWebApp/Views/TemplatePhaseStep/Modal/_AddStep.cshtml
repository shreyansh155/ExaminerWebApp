@model ExaminerWebApp.Entities.Entities.TemplatePhaseStep;
@{
    var edit = Model?.StepId == null ? true : false;
}
<script>
    window.modelData = @Html.Raw(Json.Serialize(Model))
</script>

<div class="modal" id="add-edit-step" tabindex="-1" data-bs-backdrop="static" data-bind="with: model">
    <div class="modal-dialog modal-dialog-centered modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-align-center" id="exampleModalLabel">Step</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="add-edit-step-form">
                    <div id="errorBody" class="text-danger"></div>
                    <div class="form-group required row">
                        <label for="stepname" class="col-form-label control-label col-sm-4">Step</label>
                        <div class="col-sm-8">
                            <kendo-dropdownlist id="stepname" name="steptype"
                                                data-text-field="name"
                                                data-value-field="id"
                                                option-label="--Select Step--"
                                                enable="@edit"
                                                data-bind="value: stepId"
                                                auto-bind="true">
                                <datasource>
                                    <transport>
                                        @if (!edit)
                                        {
                                            <read url="/TemplatePhaseStep/StepList?id=@Model?.Id" />
                                        }
                                        else
                                        {
                                            <read url="/TemplatePhaseStep/PhaseStepList?templatePhaseId=@Model?.TemplatePhaseId" />
                                        }
                                    </transport>
                                </datasource>
                            </kendo-dropdownlist>
                            <span class="text-danger" data-bind="visible: stepId.hasError, text: stepId.validationMessage"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="steptypeid" class="col-form-label col-sm-4">Step Type</label>
                        <div class="col-sm-8">
                            <kendo-dropdownlist id="steptypeid" name="steptype"
                                                dataTextField="name"
                                                dataValueField="id"
                                                enable=false
                                                data-bind="value: $root.stepTypeId"
                                                option-label="Select Step type">
                                <datasource>
                                    <transport>
                                        <read url="/Step/StepTypeList" />
                                    </transport>
                                </datasource>
                            </kendo-dropdownlist>
                        </div>
                    </div>
                    <div class="form-group required row">
                        <label for="ordinal" class="col-form-label control-label col-sm-4">Ordinal</label>
                        <div class="col-sm-8">
                            <kendo-numerictextbox id="ordinal"
                                                  name="ordinal"
                                                  min="1"
                                                  required="required"
                                                  format="n0"
                                                  data-bind="value: ordinal, valueUpdate: 'afterkeydown', attr: { 'aria-required': true }"
                                                  decimals="0">
                            </kendo-numerictextbox>
                            <span class="text-danger" data-bind="visible: ordinal.hasError, text: ordinal.validationMessage"></span>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-sm-4"></label>
                        <div class="d-inline-flex justify-content-start col-sm-8">
                            <kendo-radiobutton id="required" class="mx-2" name="radioBtn" label="Required"></kendo-radiobutton>
                            <kendo-radiobutton id="optional" class="mx-2" name="radioBtn" label="Optional"></kendo-radiobutton>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="stepinstruction" class="col-form-label col-sm-4">Instruction</label>
                        <div class="col-sm-8">
                            <kendo-textarea name="stepinstruction"
                                            data-bind="kendoEditor: stepinstruction, valueUpdate: 'afterkeydown'"
                                            rows="3">
                            </kendo-textarea>
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-sm-4">Require Applicant to Provide Document Proof</label>
                        <div class="d-inline-flex justify-content-start col-sm-8">
                            <input type="checkbox"
                                   id="document-proof"
                                   data-bind="checked: isRequireDocProof"
                                   class="mx-1" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-sm-4">In-house Scheduling</label>
                        <div class="d-inline-flex justify-content-start col-sm-8">
                            <input type="checkbox"
                                   id="in-house-scheduling"
                                   data-bind="checked: isInHouseScheduling"
                                   class="mx-1" />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label class="col-form-label col-sm-4">Is Notification Required?</label>
                        <div class="d-inline-flex justify-content-start col-sm-8">
                            <input type="checkbox"
                                   id="notification"
                                   data-bind="checked: isNotification"
                                   class="mx-1" />
                        </div>
                    </div>
                    <div data-bind="visible: $root.isIdNotNull">
                        <div class="card my-4">
                            <div class="card-header justify-content-between">
                                <div class="float-start">
                                    <h4>Attachments</h4>
                                </div>
                                <div class="float-end">
                                    <kendo-button name="add-attachment"
                                                  data-bind="click:$root.attachmentModal"
                                                  theme-color="ThemeColor.Primary">
                                        Add Attachment
                                    </kendo-button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="attachmentsgrid"></div>
                            </div>
                        </div>
                        <div class="card my-4" data-bind="visible: isRequireDocProof">
                            <div class="card-header">
                                <h4>Document Proof(s)</h4>
                            </div>
                            <div class="card-body">
                                <div id="documentproofgrid"></div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-start flex-row-reverse modal-footer">
                        <div class="mx-2">
                            <kendo-button name="primaryTextButton"
                                          data-bind="click: $root.formSubmit"
                                          theme-color="ThemeColor.Primary">
                                Save
                            </kendo-button>
                        </div>
                        <div class="mx-2">
                            <kendo-button name="cancelButton"
                                          data-bs-dismiss="modal"
                                          theme-color="ThemeColor.Secondary">
                                Close
                            </kendo-button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
